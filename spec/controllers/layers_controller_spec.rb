require 'spec_helper'

describe LayersController do
  include Devise::TestHelpers
  render_views

  let!(:user) { User.make }
  let!(:collection) { user.create_collection(Collection.make) }
  let!(:layer) {Layer.make collection: collection, user: user}
  let!(:layer2) {Layer.make collection: collection, user: user}
  let!(:numeric) {layer.numeric_fields.make }
  let!(:threshold) {collection.thresholds.make conditions: [ "field" => numeric.es_code, op: :lt, value: '10' ]}

  before(:each) {sign_in user}

  it "should update field.layer_id" do

    layer.fields.count.should eq(1)
    json_layer = {id: layer.id, name: layer.name, ord: layer.ord, public: layer.public, fields_attributes: {:"0" => {code: numeric.code, id: numeric.id, kind: numeric.kind, name: numeric.name, ord: numeric.ord, layer_id: layer2.id}}}

    post :update, {layer: json_layer, collection_id: collection.id, id: layer.id}

    layer.fields.count.should eq(0)
    layer2.fields.count.should eq(1)
    layer2.fields.first.name.should eq(numeric.name)

    histories = FieldHistory.where :field_id => numeric.id

    histories.count.should eq(2)

    histories.first.layer_id.should eq(layer.id)
    histories.first.valid_to.should_not be_nil

    histories.last.valid_to.should be_nil
    histories.last.layer_id.should eq(layer2.id)

  end

  it "should return layer json with associated threshold ids" do
    get :index, collection_id: collection.id, format: 'json'
    json = JSON.parse response.body
    #expect(response.body).to match /threshold_ids/

    json[0]["threshold_ids"].should eq [threshold.id]

  end
  
  describe 'analytic' do
    it 'should changed user.layer_count by 1' do
      expect {
        post :create, layer: { name: 'layer_01', fields: [], ord: 1}, collection_id: collection.id
      }.to change{
        u = User.find user
        u.layer_count
      }.from(0).to(1)
    end
  end

  describe 'create layer' do
    it "should save layer" do
      config_locations = {"0"=>{"code"=>"257", "name"=>"Achar Leak", "latitude"=>"12.7237", "longitude"=>"104.893997"}, "1"=>{"code"=>"1574", "name"=>"Aekakpheap", "latitude"=>"13.8067", "longitude"=>"104.958"}, "2"=>{"code"=>"600", "name"=>"Ampeng", "latitude"=>"10.4928", "longitude"=>"104.387001"}, "3"=>{"code"=>"736", "name"=>"Ampil", "latitude"=>"11.4571", "longitude"=>"105.811996"}, "4"=>{"code"=>"391", "name"=>"Ampil Chas", "latitude"=>"14.233", "longitude"=>"103.129997"}, "5"=>{"code"=>"1486", "name"=>"Ampil Leu", "latitude"=>"12.0016", "longitude"=>"105.444"}, "6"=>{"code"=>"1170", "name"=>"Ampil Tuek", "latitude"=>"11.2693", "longitude"=>"105.272003"}, "7"=>{"code"=>"528", "name"=>"Ampov Prey", "latitude"=>"10.8859", "longitude"=>"105.288002"}, "8"=>{"code"=>"196", "name"=>"Andong Pir", "latitude"=>"13.3827", "longitude"=>"102.364998"}, "9"=>{"code"=>"472", "name"=>"Andoung", "latitude"=>"11.2344", "longitude"=>"105.367996"}, "10"=>{"code"=>"1300", "name"=>"Andoung Chek", "latitude"=>"12.1303", "longitude"=>"104.622002"}, "11"=>{"code"=>"1360", "name"=>"Andoung Chraoh", "latitude"=>"12.013", "longitude"=>"105.429001"}, "12"=>{"code"=>"1770", "name"=>"Andoung Kraloeng", "latitude"=>"12.3183", "longitude"=>"107.087997"}, "13"=>{"code"=>"444", "name"=>"Andoung Pou", "latitude"=>"13.8035", "longitude"=>"104.795998"}, "14"=>{"code"=>"145", "name"=>"Andoung Pring", "latitude"=>"13.0599", "longitude"=>"103.158997"}, "15"=>{"code"=>"1267", "name"=>"Andoung Rovieng", "latitude"=>"12.362", "longitude"=>"104.445"}, "16"=>{"code"=>"454", "name"=>"Andoung S'at", "latitude"=>"11.6215", "longitude"=>"105.746002"}, "17"=>{"code"=>"179", "name"=>"Andoung Taa Pech", "latitude"=>"12.1479", "longitude"=>"105.246002"}, "18"=>{"code"=>"1239", "name"=>"Andoung Tuek", "latitude"=>"11.1864", "longitude"=>"103.475998"}, "19"=>{"code"=>"1057", "name"=>"Angk", "latitude"=>"10.6126", "longitude"=>"104.245003"}, "20"=>{"code"=>"1017", "name"=>"Angk Doun Pis", "latitude"=>"11.3294", "longitude"=>"104.624001"}, "21"=>{"code"=>"823", "name"=>"Angk Kabbas", "latitude"=>"11.1616", "longitude"=>"105.713997"}, "22"=>{"code"=>"672", "name"=>"Angk Khcheay Khang Cheung", "latitude"=>"10.8337", "longitude"=>"104.586998"}, "23"=>{"code"=>"289", "name"=>"Angk Khloam", "latitude"=>"13.0342", "longitude"=>"104.514"}, "24"=>{"code"=>"1134", "name"=>"Angk Klaeu", "latitude"=>"11.353", "longitude"=>"104.777"}, "25"=>{"code"=>"1686", "name"=>"Angk Metrei", "latitude"=>"11.4318", "longitude"=>"104.658997"}, "26"=>{"code"=>"1660", "name"=>"Angk Neareay", "latitude"=>"11.0179", "longitude"=>"104.725998"}, "27"=>{"code"=>"907", "name"=>"Angk Reang", "latitude"=>"11.112", "longitude"=>"104.720001"}, "28"=>{"code"=>"1003", "name"=>"Angk Romeas", "latitude"=>"11.3236", "longitude"=>"104.705002"}, "29"=>{"code"=>"1619", "name"=>"Angk Rumduol", "latitude"=>"10.806", "longitude"=>"104.660004"}, "30"=>{"code"=>"1672", "name"=>"Angk Serei", "latitude"=>"11.4694", "longitude"=>"104.547997"}, "31"=>{"code"=>"1710", "name"=>"Angk Snuol Ti Pir", "latitude"=>"11.505", "longitude"=>"104.719002"}, "32"=>{"code"=>"1061", "name"=>"Angk Ta Mau", "latitude"=>"11.4711", "longitude"=>"104.456001"}, "33"=>{"code"=>"1461", "name"=>"Angk Ta Saom", "latitude"=>"11.0091", "longitude"=>"104.677002"}, "34"=>{"code"=>"949", "name"=>"Angk Tnaot Khang Kaeut", "latitude"=>"10.9924", "longitude"=>"104.670998"}, "35"=>{"code"=>"1052", "name"=>"Angk Tonloab", "latitude"=>"11.5357", "longitude"=>"104.598999"}, "36"=>{"code"=>"964", "name"=>"Angk Trav", "latitude"=>"11.0426", "longitude"=>"104.575996"}, "37"=>{"code"=>"1503", "name"=>"Angkor Ban Ti Bei", "latitude"=>"11.9463", "longitude"=>"105.227997"}, "38"=>{"code"=>"83", "name"=>"Angkor Ban Ti Buon", "latitude"=>"11.9482", "longitude"=>"105.222"}, "39"=>{"code"=>"1656", "name"=>"Angkor Phdiek", "latitude"=>"11.1437", "longitude"=>"104.759003"}, "40"=>{"code"=>"513", "name"=>"Angkor Sar", "latitude"=>"11.249", "longitude"=>"105.626999"}, "41"=>{"code"=>"537", "name"=>"Angkor Tret", "latitude"=>"11.534", "longitude"=>"105.450996"}, "42"=>{"code"=>"461", "name"=>"Angkrong", "latitude"=>"11.0167", "longitude"=>"105.532997"}, "43"=>{"code"=>"30", "name"=>"Anglong Svay", "latitude"=>"13.6231", "longitude"=>"102.683998"}, "44"=>{"code"=>"1046", "name"=>"Angvae", "latitude"=>"11.3617", "longitude"=>"104.526001"}, "45"=>{"code"=>"304", "name"=>"Anhchanh", "latitude"=>"12.4807", "longitude"=>"106.125999"}, "46"=>{"code"=>"1500", "name"=>"Anlok Kaong", "latitude"=>"12.9539", "longitude"=>"103.149002"}, "47"=>{"code"=>"806", "name"=>"Anlong Chrey", "latitude"=>"13.7643", "longitude"=>"105.661003"}, "48"=>{"code"=>"1694", "name"=>"Anlong Kngan", "latitude"=>"11.6185", "longitude"=>"104.850998"}, "49"=>{"code"=>"1055", "name"=>"Anlong Meakprang", "latitude"=>"10.7021", "longitude"=>"104.177002"}, "50"=>{"code"=>"703", "name"=>"Anlong Pir", "latitude"=>"13.3068", "longitude"=>"104.042999"}, "51"=>{"code"=>"334", "name"=>"Anlong Preah Kou", "latitude"=>"12.6537", "longitude"=>"105.999001"}, "52"=>{"code"=>"1089", "name"=>"Anlong Romiet Khang Cheung", "latitude"=>"11.4232", "longitude"=>"104.810997"}, "53"=>{"code"=>"1617", "name"=>"Anlong Samnar", "latitude"=>"13.0663", "longitude"=>"104.293999"}, "54"=>{"code"=>"1022", "name"=>"Anlong Sangkae", "latitude"=>"11.665", "longitude"=>"104.125"}, "55"=>{"code"=>"1167", "name"=>"Anlong Sant", "latitude"=>"11.082", "longitude"=>"105.064003"}, "56"=>{"code"=>"584", "name"=>"Anlong Sar", "latitude"=>"11.8163", "longitude"=>"105.371002"}, "57"=>{"code"=>"734", "name"=>"Anlong Spean", "latitude"=>"11.1809", "longitude"=>"105.787003"}, "58"=>{"code"=>"33", "name"=>"Anlong Svay", "latitude"=>"13.7008", "longitude"=>"102.862999"}, "59"=>{"code"=>"342", "name"=>"Anlong Ta Uor", "latitude"=>"13.2307", "longitude"=>"103.661003"}, "60"=>{"code"=>"768", "name"=>"Anlong Thum", "latitude"=>"13.536", "longitude"=>"104.174004"}, "61"=>{"code"=>"840", "name"=>"Anlong Tien", "latitude"=>"10.846", "longitude"=>"104.996002"}, "62"=>{"code"=>"552", "name"=>"Anlong Trea", "latitude"=>"11.4558", "longitude"=>"105.282997"}, "63"=>{"code"=>"1246", "name"=>"Anlong Vak", "latitude"=>"11.5627", "longitude"=>"103.135002"}, "64"=>{"code"=>"602", "name"=>"Anlong Vil", "latitude"=>"12.6176", "longitude"=>"104.004997"}, "65"=>{"code"=>"459", "name"=>"Ansaong", "latitude"=>"11.1238", "longitude"=>"105.544998"}, "66"=>{"code"=>"918", "name"=>"Ba Tang", "latitude"=>"13.5406", "longitude"=>"107.024002"}, "67"=>{"code"=>"1448", "name"=>"Bacham", "latitude"=>"11.2404", "longitude"=>"104.816002"}, "68"=>{"code"=>"166", "name"=>"Baek Anlung", "latitude"=>"12.3592", "longitude"=>"105.596001"}, "69"=>{"code"=>"1194", "name"=>"Baek Chan", "latitude"=>"11.5065", "longitude"=>"104.753998"}, "70"=>{"code"=>"1218", "name"=>"Baek Thlang", "latitude"=>"11.7331", "longitude"=>"104.733002"}, "71"=>{"code"=>"757", "name"=>"Bak Dai", "latitude"=>"10.8966", "longitude"=>"105.039001"}, "72"=>{"code"=>"1145", "name"=>"Bak Dav Kraom", "latitude"=>"11.5965", "longitude"=>"105.114998"}, "73"=>{"code"=>"446", "name"=>"Bak Kam", "latitude"=>"13.7826", "longitude"=>"104.852997"}, "74"=>{"code"=>"1572", "name"=>"Bak Kdaong", "latitude"=>"13.3665", "longitude"=>"105.116997"}, "75"=>{"code"=>"1723", "name"=>"Bak Khlang Mouy", "latitude"=>"11.5656", "longitude"=>"102.959"}, "76"=>{"code"=>"1249", "name"=>"Bak Khlang Pir", "latitude"=>"11.5654", "longitude"=>"102.959999"}, "77"=>{"code"=>"206", "name"=>"Bak Prea", "latitude"=>"13.3129", "longitude"=>"103.406998"}, "78"=>{"code"=>"566", "name"=>"Bak Roteh", "latitude"=>"12.5325", "longitude"=>"103.93"}, "79"=>{"code"=>"223", "name"=>"Bak Sna Kraom", "latitude"=>"12.5116", "longitude"=>"105.285004"}, "80"=>{"code"=>"266", "name"=>"Bak Srei", "latitude"=>"12.8836", "longitude"=>"105.071999"}, "81"=>{"code"=>"1349", "name"=>"Bakham", "latitude"=>"12.1841", "longitude"=>"105.129997"}, "82"=>{"code"=>"189", "name"=>"Balang Khang Lech", "latitude"=>"12.6954", "longitude"=>"104.901001"}, "83"=>{"code"=>"34", "name"=>"Baliley", "latitude"=>"13.6622", "longitude"=>"102.578003"}, "84"=>{"code"=>"61", "name"=>"Ballangk", "latitude"=>"13.4695", "longitude"=>"102.733002"}, "85"=>{"code"=>"1638", "name"=>"Ban Mai", "latitude"=>"13.5468", "longitude"=>"106.088997"}, "86"=>{"code"=>"1658", "name"=>"Ban Phang", "latitude"=>"13.9723", "longitude"=>"106.827003"}, "87"=>{"code"=>"942", "name"=>"Ban Pong", "latitude"=>"13.9701", "longitude"=>"106.834"}, "88"=>{"code"=>"1256", "name"=>"Ban Tiet", "latitude"=>"11.1348", "longitude"=>"103.754997"}, "89"=>{"code"=>"1395", "name"=>"Banan", "latitude"=>"12.9492", "longitude"=>"103.148003"}, "90"=>{"code"=>"1555", "name"=>"Banang", "latitude"=>"12.8848", "longitude"=>"102.972"}, "91"=>{"code"=>"2", "name"=>"Bang Bat Kaeut", "latitude"=>"13.5182", "longitude"=>"102.992996"}, "92"=>{"code"=>"1430", "name"=>"Bangaek", "latitude"=>"11.1016", "longitude"=>"105.223999"}, "93"=>{"code"=>"129", "name"=>"Bangkov", "latitude"=>"11.7858", "longitude"=>"106.123001"}, "94"=>{"code"=>"1113", "name"=>"Banla S'et", "latitude"=>"11.6072", "longitude"=>"104.873001"}, "95"=>{"code"=>"399", "name"=>"Bansay Reak", "latitude"=>"14.2334", "longitude"=>"103.464996"}, "96"=>{"code"=>"182", "name"=>"Banteay", "latitude"=>"11.8475", "longitude"=>"105.197998"}, "97"=>{"code"=>"704", "name"=>"Banteay Chas", "latitude"=>"13.3567", "longitude"=>"103.874001"}, "98"=>{"code"=>"43", "name"=>"Banteay Chhmar Tboung", "latitude"=>"14.0636", "longitude"=>"103.107002"}, "99"=>{"code"=>"1498", "name"=>"Banteay Mean Rit", "latitude"=>"13.986", "longitude"=>"102.865997"}, "100"=>{"code"=>"1", "name"=>"Banteay Neang", "latitude"=>"13.5105", "longitude"=>"103.019997"}, "101"=>{"code"=>"633", "name"=>"Banteay Srei", "latitude"=>"13.5881", "longitude"=>"103.962997"}, "102"=>{"code"=>"250", "name"=>"Banteay Stoung", "latitude"=>"12.9285", "longitude"=>"104.649002"}, "103"=>{"code"=>"57", "name"=>"Banteay Ti Pir", "latitude"=>"13.5591", "longitude"=>"102.487"}, "104"=>{"code"=>"1540", "name"=>"Banteay Yumreach", "latitude"=>"12.5254", "longitude"=>"105.100998"}, "105"=>{"code"=>"1562", "name"=>"Baoh Pou", "latitude"=>"13.0606", "longitude"=>"103.211998"}, "106"=>{"code"=>"547", "name"=>"Baray Lech", "latitude"=>"11.4622", "longitude"=>"105.347"}, "107"=>{"code"=>"1406", "name"=>"Baray Touch", "latitude"=>"12.3929", "longitude"=>"105.085999"}, "108"=>{"code"=>"1468", "name"=>"Barku", "latitude"=>"11.4087", "longitude"=>"104.830002"}, "109"=>{"code"=>"344", "name"=>"Basaet", "latitude"=>"13.1152", "longitude"=>"103.308998"}, "110"=>{"code"=>"1614", "name"=>"Bat", "latitude"=>"13.7313", "longitude"=>"103.671997"}, "111"=>{"code"=>"1025", "name"=>"Bat Doeng", "latitude"=>"11.6811", "longitude"=>"104.702003"}, "112"=>{"code"=>"361", "name"=>"Bat Kokir", "latitude"=>"10.5852", "longitude"=>"103.766998"}, "113"=>{"code"=>"96", "name"=>"Bat Srei Totueng", "latitude"=>"11.8383", "longitude"=>"105.393997"}, "114"=>{"code"=>"1324", "name"=>"Batheay", "latitude"=>"11.988", "longitude"=>"104.945999"}, "115"=>{"code"=>"478", "name"=>"Bati", "latitude"=>"11.3269", "longitude"=>"105.296997"}, "116"=>{"code"=>"1722", "name"=>"Battachi", "latitude"=>"11.4534", "longitude"=>"104.934998"}, "117"=>{"code"=>"1373", "name"=>"Bavel Muoy", "latitude"=>"13.2535", "longitude"=>"102.877998"}, "118"=>{"code"=>"1499", "name"=>"Bay Damram", "latitude"=>"12.9939", "longitude"=>"103.164001"}, "119"=>{"code"=>"455", "name"=>"Bayab", "latitude"=>"11.6458", "longitude"=>"105.5"}, "120"=>{"code"=>"1750", "name"=>"Bei Maetr", "latitude"=>"12.1161", "longitude"=>"105.686996"}, "121"=>{"code"=>"503", "name"=>"Beng", "latitude"=>"11.0341", "longitude"=>"105.566002"}, "122"=>{"code"=>"492", "name"=>"Beng Sat", "latitude"=>"13.3048", "longitude"=>"102.366997"}, "123"=>{"code"=>"1281", "name"=>"Ber", "latitude"=>"12.2512", "longitude"=>"104.666"}, "124"=>{"code"=>"689", "name"=>"Boeng", "latitude"=>"13.3654", "longitude"=>"103.780998"}, "125"=>{"code"=>"1608", "name"=>"Boeng Chak", "latitude"=>"12.6202", "longitude"=>"104.011002"}, "126"=>{"code"=>"588", "name"=>"Boeng Chhuk", "latitude"=>"12.5906", "longitude"=>"103.727997"}, "127"=>{"code"=>"583", "name"=>"Boeng Choar", "latitude"=>"11.7389", "longitude"=>"105.366997"}, "128"=>{"code"=>"560", "name"=>"Boeng Daol", "latitude"=>"11.0574", "longitude"=>"105.338997"}, "129"=>{"code"=>"1128", "name"=>"Boeng Kaek", "latitude"=>"11.3584", "longitude"=>"104.853996"}, "130"=>{"code"=>"559", "name"=>"Boeng Kampot", "latitude"=>"11.0099", "longitude"=>"105.380997"}, "131"=>{"code"=>"226", "name"=>"Boeng Kandal", "latitude"=>"12.427", "longitude"=>"105.113998"}, "132"=>{"code"=>"587", "name"=>"Boeng Khnar", "latitude"=>"12.6323", "longitude"=>"103.732002"}, "133"=>{"code"=>"1090", "name"=>"Boeng Khyang", "latitude"=>"11.3599", "longitude"=>"104.875"}, "134"=>{"code"=>"1176", "name"=>"Boeng Krum Kraom", "latitude"=>"11.4738", "longitude"=>"105.167"}, "135"=>{"code"=>"576", "name"=>"Boeng Laeng", "latitude"=>"11.8086", "longitude"=>"105.334"}, "136"=>{"code"=>"1313", "name"=>"Boeng Leach", "latitude"=>"11.8866", "longitude"=>"104.690002"}, "137"=>{"code"=>"282", "name"=>"Boeng Lvea", "latitude"=>"12.5404", "longitude"=>"105.153999"}, "138"=>{"code"=>"477", "name"=>"Boeng Phsaot", "latitude"=>"11.3555", "longitude"=>"105.271004"}, "139"=>{"code"=>"1252", "name"=>"Boeng Preav", "latitude"=>"11.0924", "longitude"=>"103.779999"}, "140"=>{"code"=>"100", "name"=>"Boeng Pring", "latitude"=>"13.3615", "longitude"=>"103.039001"}, "141"=>{"code"=>"987", "name"=>"Boeng Ta Mom", "latitude"=>"11.1321", "longitude"=>"104.468002"}, "142"=>{"code"=>"357", "name"=>"Boeng Ta Prum", "latitude"=>"10.5704", "longitude"=>"103.779999"}, "143"=>{"code"=>"1447", "name"=>"Boeng Thnong", "latitude"=>"11.1468", "longitude"=>"104.541"}, "144"=>{"code"=>"996", "name"=>"Boeng Thum Khang Lech", "latitude"=>"10.5532", "longitude"=>"104.503998"}, "145"=>{"code"=>"911", "name"=>"Boeng Tranh", "latitude"=>"11.0927", "longitude"=>"104.746002"}, "146"=>{"code"=>"1423", "name"=>"Boeng Veaeng", "latitude"=>"10.705", "longitude"=>"103.820999"}, "147"=>{"code"=>"423", "name"=>"Boh", "latitude"=>"13.7877", "longitude"=>"105.272003"}, "148"=>{"code"=>"671", "name"=>"Bon", "latitude"=>"10.8933", "longitude"=>"106.057999"}, "149"=>{"code"=>"1126", "name"=>"Bonna", "latitude"=>"11.416", "longitude"=>"104.869003"}, "150"=>{"code"=>"1708", "name"=>"Borei Kammeakkar", "latitude"=>"11.5103", "longitude"=>"104.762001"}, "151"=>{"code"=>"295", "name"=>"Bos", "latitude"=>"12.1636", "longitude"=>"106.078003"}, "152"=>{"code"=>"1335", "name"=>"Bos Khnaor", "latitude"=>"12.1779", "longitude"=>"105.325996"}, "153"=>{"code"=>"1490", "name"=>"Bos Laok", "latitude"=>"13.3871", "longitude"=>"102.934998"}, "154"=>{"code"=>"302", "name"=>"Bos Leav Kraom", "latitude"=>"12.4039", "longitude"=>"106.045998"}, "155"=>{"code"=>"1047", "name"=>"Bos Nhinh", "latitude"=>"10.6008", "longitude"=>"104.277"}, "156"=>{"code"=>"1525", "name"=>"Bos Pou", "latitude"=>"12.2962", "longitude"=>"105.413002"}, "157"=>{"code"=>"1592", "name"=>"Bos Roluoy", "latitude"=>"11.0246", "longitude"=>"105.385002"}, "158"=>{"code"=>"36", "name"=>"Bos Sbov", "latitude"=>"13.667", "longitude"=>"103.051003"}, "159"=>{"code"=>"729", "name"=>"Bos Svay", "latitude"=>"11.2343", "longitude"=>"105.885002"}, "160"=>{"code"=>"400", "name"=>"Bosbov", "latitude"=>"14.1333", "longitude"=>"103.489998"}, "161"=>{"code"=>"291", "name"=>"Botum Lech", "latitude"=>"12.933", "longitude"=>"104.679001"}, "162"=>{"code"=>"1143", "name"=>"Campuh Kaek", "latitude"=>"11.4799", "longitude"=>"104.958"}, "163"=>{"code"=>"812", "name"=>"Chaeng Maeng", "latitude"=>"11.2019", "longitude"=>"105.709999"}, "164"=>{"code"=>"132", "name"=>"Chak", "latitude"=>"11.7728", "longitude"=>"105.599998"}, "165"=>{"code"=>"363", "name"=>"Chak Cha", "latitude"=>"12.3708", "longitude"=>"106.728996"}, "166"=>{"code"=>"1594", "name"=>"Chakrei", "latitude"=>"13.3032", "longitude"=>"102.616997"}, "167"=>{"code"=>"1716", "name"=>"Chakto Tis", "latitude"=>"11.8208", "longitude"=>"104.768997"}, "168"=>{"code"=>"1264", "name"=>"Cham Srei", "latitude"=>"11.0897", "longitude"=>"103.905998"}, "169"=>{"code"=>"500", "name"=>"Chambak", "latitude"=>"11.1443", "longitude"=>"105.542999"}, "170"=>{"code"=>"676", "name"=>"Chambak Haer", "latitude"=>"13.6071", "longitude"=>"103.427002"}, "171"=>{"code"=>"816", "name"=>"Chambak Kaong", "latitude"=>"11.0893", "longitude"=>"105.709"}, "172"=>{"code"=>"323", "name"=>"Chambak Ti Muoy", "latitude"=>"12.272", "longitude"=>"105.813004"}, "173"=>{"code"=>"886", "name"=>"Chambak Tuem", "latitude"=>"10.6189", "longitude"=>"104.880997"}, "174"=>{"code"=>"1336", "name"=>"Chamkar Andoung", "latitude"=>"12.3379", "longitude"=>"105.181"}, "175"=>{"code"=>"565", "name"=>"Chamkar Chek Khang Cheung", "latitude"=>"12.5441", "longitude"=>"103.915001"}, "176"=>{"code"=>"1774", "name"=>"Chamkar Chrey Khang Cheung", "latitude"=>"12.2756", "longitude"=>"103.018997"}, "177"=>{"code"=>"1007", "name"=>"Chamkar Doung", "latitude"=>"11.2236", "longitude"=>"104.671997"}, "178"=>{"code"=>"359", "name"=>"Chamkar Kausu", "latitude"=>"10.7317", "longitude"=>"103.808998"}, "179"=>{"code"=>"540", "name"=>"Chamkar Kuoy Lech", "latitude"=>"11.4912", "longitude"=>"105.442001"}, "180"=>{"code"=>"1640", "name"=>"Chamkar Leu", "latitude"=>"13.5112", "longitude"=>"105.738998"}, "181"=>{"code"=>"1263", "name"=>"Chamkar Luong", "latitude"=>"11.0406", "longitude"=>"103.803001"}, "182"=>{"code"=>"63", "name"=>"Chamkar Ou", "latitude"=>"12.9262", "longitude"=>"103.143997"}, "183"=>{"code"=>"127", "name"=>"Chamkar Ruessei", "latitude"=>"13.0824", "longitude"=>"103.212997"}, "184"=>{"code"=>"142", "name"=>"Chamkar Samraong Pir", "latitude"=>"13.111", "longitude"=>"103.203003"}, "185"=>{"code"=>"495", "name"=>"Chamkar Srov", "latitude"=>"13.3508", "longitude"=>"102.352997"}, "186"=>{"code"=>"494", "name"=>"Chamkar Trab", "latitude"=>"13.37", "longitude"=>"102.358002"}, "187"=>{"code"=>"3", "name"=>"Chamnaom Kaeut", "latitude"=>"13.4413", "longitude"=>"102.941002"}, "188"=>{"code"=>"358", "name"=>"Chamnaot Ream", "latitude"=>"10.5981", "longitude"=>"103.627998"}, "189"=>{"code"=>"371", "name"=>"Chamraeun", "latitude"=>"13.0361", "longitude"=>"107.026001"}, "190"=>{"code"=>"1511", "name"=>"Chan Mul", "latitude"=>"11.737", "longitude"=>"106.245003"}, "191"=>{"code"=>"449", "name"=>"Chan Ra Ka", "latitude"=>"11.2513", "longitude"=>"105.514999"}, "192"=>{"code"=>"1662", "name"=>"Chan Teab", "latitude"=>"10.9945", "longitude"=>"104.600998"}, "193"=>{"code"=>"66", "name"=>"Changhour Svay", "latitude"=>"12.8692", "longitude"=>"103.108002"}, "194"=>{"code"=>"898", "name"=>"Changkaeub", "latitude"=>"11.0862", "longitude"=>"104.882004"}, "195"=>{"code"=>"992", "name"=>"Changriek", "latitude"=>"11.2414", "longitude"=>"104.546997"}, "196"=>{"code"=>"675", "name"=>"Chanlas Dai", "latitude"=>"13.6324", "longitude"=>"103.459999"}, "197"=>{"code"=>"1586", "name"=>"Chant Kruesna", "latitude"=>"11.3374", "longitude"=>"105.627998"}, "198"=>{"code"=>"653", "name"=>"Chantrea", "latitude"=>"10.8623", "longitude"=>"106.089996"}, "199"=>{"code"=>"740", "name"=>"Chantrei", "latitude"=>"11.2835", "longitude"=>"105.727997"}, "200"=>{"code"=>"74", "name"=>"Char", "latitude"=>"13.1645", "longitude"=>"103.039001"}, "201"=>{"code"=>"920", "name"=>"Char Ung Chan", "latitude"=>"13.7412", "longitude"=>"106.955002"}, "202"=>{"code"=>"1326", "name"=>"Chea Lea", "latitude"=>"11.9115", "longitude"=>"104.931999"}, "203"=>{"code"=>"311", "name"=>"Chea Montrei", "latitude"=>"12.8345", "longitude"=>"102.916"}, "204"=>{"code"=>"1627", "name"=>"Chea Sman", "latitude"=>"13.2929", "longitude"=>"104.002998"}, "205"=>{"code"=>"451", "name"=>"Cheach Khang Lech", "latitude"=>"11.6841", "longitude"=>"105.705002"}, "206"=>{"code"=>"1352", "name"=>"Cheach Thum", "latitude"=>"11.9089", "longitude"=>"105.865997"}, "207"=>{"code"=>"658", "name"=>"Chek", "latitude"=>"10.9286", "longitude"=>"106.130997"}, "208"=>{"code"=>"609", "name"=>"Chek Chau", "latitude"=>"12.5754", "longitude"=>"104.094002"}, "209"=>{"code"=>"975", "name"=>"Chen", "latitude"=>"10.7942", "longitude"=>"104.758003"}, "210"=>{"code"=>"4", "name"=>"Cheung Chab", "latitude"=>"13.4695", "longitude"=>"103.105003"}, "211"=>{"code"=>"1736", "name"=>"Cheung Chhnok", "latitude"=>"11.8784", "longitude"=>"104.940002"}, "212"=>{"code"=>"336", "name"=>"Cheung Khlu", "latitude"=>"12.0514", "longitude"=>"106.459"}, "213"=>{"code"=>"1735", "name"=>"Cheung Prey", "latitude"=>"12.0544", "longitude"=>"104.973"}, "214"=>{"code"=>"395", "name"=>"Cheung Tien", "latitude"=>"13.9186", "longitude"=>"103.553001"}, "215"=>{"code"=>"1429", "name"=>"Cheung Tuek", "latitude"=>"11.6903", "longitude"=>"105.563004"}, "216"=>{"code"=>"548", "name"=>"Cheung Tuek Ka", "latitude"=>"11.4982", "longitude"=>"105.330002"}, "217"=>{"code"=>"23", "name"=>"Cheung Voat", "latitude"=>"13.5934", "longitude"=>"103.183998"}, "218"=>{"code"=>"283", "name"=>"Chey Mongkol", "latitude"=>"12.594", "longitude"=>"105.018997"}, "219"=>{"code"=>"1753", "name"=>"Chey Nikom", "latitude"=>"11.8785", "longitude"=>"105.813004"}, "220"=>{"code"=>"412", "name"=>"Chey Nivot", "latitude"=>"14.2811", "longitude"=>"104.455002"}, "221"=>{"code"=>"420", "name"=>"Chhaeb Lech", "latitude"=>"13.7635", "longitude"=>"105.406998"}, "222"=>{"code"=>"1196", "name"=>"Chhak Chheu Neang", "latitude"=>"11.5231", "longitude"=>"104.737999"}, "223"=>{"code"=>"1318", "name"=>"Chhak Kandaol", "latitude"=>"12.0012", "longitude"=>"104.43"}, "224"=>{"code"=>"1570", "name"=>"Chhak Roka", "latitude"=>"12.5681", "longitude"=>"102.744003"}, "225"=>{"code"=>"506", "name"=>"Chhaoeng Chumnir", "latitude"=>"11.707", "longitude"=>"105.555"}, "226"=>{"code"=>"778", "name"=>"Chhay", "latitude"=>"10.7169", "longitude"=>"104.535004"}, "227"=>{"code"=>"1424", "name"=>"Chheu Kach", "latitude"=>"11.252", "longitude"=>"105.402"}, "228"=>{"code"=>"1124", "name"=>"Chheu Neang", "latitude"=>"11.404", "longitude"=>"104.846001"}, "229"=>{"code"=>"254", "name"=>"Chheu Teal", "latitude"=>"12.9415", "longitude"=>"104.570999"}, "230"=>{"code"=>"1646", "name"=>"Chheu Teal Bak", "latitude"=>"10.9152", "longitude"=>"104.835999"}, "231"=>{"code"=>"210", "name"=>"Chheu Teal Chrum", "latitude"=>"11.8441", "longitude"=>"105.727997"}, "232"=>{"code"=>"298", "name"=>"Chheu Teal Phluoh Kraom", "latitude"=>"12.2951", "longitude"=>"106.040001"}, "233"=>{"code"=>"1579", "name"=>"Chheu Traeng", "latitude"=>"11.3147", "longitude"=>"105.397003"}, "234"=>{"code"=>"538", "name"=>"Chhkae Koun", "latitude"=>"11.5824", "longitude"=>"105.474998"}, "235"=>{"code"=>"910", "name"=>"Chhlit Leu", "latitude"=>"10.6464", "longitude"=>"104.473"}, "236"=>{"code"=>"1513", "name"=>"Chhloung Muoy", "latitude"=>"11.9092", "longitude"=>"106.081001"}, "237"=>{"code"=>"1088", "name"=>"Chhmar Puon", "latitude"=>"11.3793", "longitude"=>"104.898003"}, "238"=>{"code"=>"557", "name"=>"Chhnal Moan", "latitude"=>"12.7123", "longitude"=>"103.217003"}, "239"=>{"code"=>"1268", "name"=>"Chhnok Tru", "latitude"=>"12.3662", "longitude"=>"104.449997"}, "240"=>{"code"=>"1386", "name"=>"Chhnuon", "latitude"=>"13.4257", "longitude"=>"105.217003"}, "241"=>{"code"=>"1493", "name"=>"Chhnuor", "latitude"=>"13.6328", "longitude"=>"103.110001"}, "242"=>{"code"=>"402", "name"=>"Chhuk", "latitude"=>"14.1935", "longitude"=>"103.518997"}, "243"=>{"code"=>"229", "name"=>"Chhuk Khsach", "latitude"=>"12.3954", "longitude"=>"105.114998"}, "244"=>{"code"=>"265", "name"=>"Chhuk Stueng", "latitude"=>"12.8691", "longitude"=>"105.132004"}, "245"=>{"code"=>"501", "name"=>"Chhvang", "latitude"=>"11.1089", "longitude"=>"105.599998"}, "246"=>{"code"=>"1209", "name"=>"Chhveang", "latitude"=>"11.6736", "longitude"=>"104.786003"}, "247"=>{"code"=>"1254", "name"=>"Chi Kha Lue", "latitude"=>"11.1701", "longitude"=>"103.679001"}, "248"=>{"code"=>"873", "name"=>"Chi Mreak", "latitude"=>"10.657", "longitude"=>"104.714996"}, "249"=>{"code"=>"310", "name"=>"Chi Pang", "latitude"=>"12.8126", "longitude"=>"102.894997"}, "250"=>{"code"=>"1754", "name"=>"Chi Peang", "latitude"=>"11.7823", "longitude"=>"106.010002"}, "251"=>{"code"=>"1261", "name"=>"Chi Phat", "latitude"=>"11.3274", "longitude"=>"103.529999"}, "252"=>{"code"=>"738", "name"=>"Chik Dei", "latitude"=>"11.5503", "longitude"=>"105.754997"}, "253"=>{"code"=>"1518", "name"=>"Chimoan Cheung", "latitude"=>"11.7707", "longitude"=>"105.945999"}, "254"=>{"code"=>"214", "name"=>"Chirou Kraom Ti Pir", "latitude"=>"12.0125", "longitude"=>"105.498001"}, "255"=>{"code"=>"268", "name"=>"Choam Boeng", "latitude"=>"12.8639", "longitude"=>"105.165001"}, "256"=>{"code"=>"426", "name"=>"Choam Khsant", "latitude"=>"14.2171", "longitude"=>"104.943001"}, "257"=>{"code"=>"122", "name"=>"Choam Triek", "latitude"=>"11.8124", "longitude"=>"106.206001"}, "258"=>{"code"=>"817", "name"=>"Choar Dom", "latitude"=>"10.7967", "longitude"=>"104.518997"}, "259"=>{"code"=>"20", "name"=>"Chob", "latitude"=>"13.6224", "longitude"=>"103.186996"}, "260"=>{"code"=>"769", "name"=>"Chob Kraom", "latitude"=>"13.5371", "longitude"=>"104.25"}, "261"=>{"code"=>"1533", "name"=>"Chob Krau", "latitude"=>"11.9156", "longitude"=>"105.609001"}, "262"=>{"code"=>"1449", "name"=>"Chob Leu", "latitude"=>"13.5461", "longitude"=>"104.247002"}, "263"=>{"code"=>"505", "name"=>"Chong Ampil", "latitude"=>"11.6615", "longitude"=>"105.429001"}, "264"=>{"code"=>"1418", "name"=>"Chong Kal", "latitude"=>"13.9501", "longitude"=>"103.577003"}, "265"=>{"code"=>"1700", "name"=>"Chong Kaoh", "latitude"=>"11.048", "longitude"=>"105.078003"}, "266"=>{"code"=>"271", "name"=>"Chong Pralay", "latitude"=>"12.8018", "longitude"=>"103.463997"}, "267"=>{"code"=>"1742", "name"=>"Chong Thnal Khang Lech", "latitude"=>"11.5601", "longitude"=>"104.878998"}, "268"=>{"code"=>"1673", "name"=>"Chongruk", "latitude"=>"11.2954", "longitude"=>"104.703003"}, "269"=>{"code"=>"533", "name"=>"Chouk Chey", "latitude"=>"11.3774", "longitude"=>"105.335999"}, "270"=>{"code"=>"1422", "name"=>"Chour Ti Muoy", "latitude"=>"11.5723", "longitude"=>"105.666"}, "271"=>{"code"=>"1576", "name"=>"Chour Ti Pir", "latitude"=>"11.5773", "longitude"=>"105.668999"}, "272"=>{"code"=>"673", "name"=>"Chrab", "latitude"=>"10.7007", "longitude"=>"104.653"}, "273"=>{"code"=>"1005", "name"=>"Chrab Tboun", "latitude"=>"11.402", "longitude"=>"104.755997"}, "274"=>{"code"=>"312", "name"=>"Chrab Veal", "latitude"=>"13.0828", "longitude"=>"103.228996"}, "275"=>{"code"=>"216", "name"=>"Chrak Chambak", "latitude"=>"11.9166", "longitude"=>"105.593002"}, "276"=>{"code"=>"1311", "name"=>"Chrak Tnaot", "latitude"=>"11.7463", "longitude"=>"104.485001"}, "277"=>{"code"=>"322", "name"=>"Chranaol", "latitude"=>"12.4993", "longitude"=>"106.236"}, "278"=>{"code"=>"765", "name"=>"Chranieng", "latitude"=>"13.8882", "longitude"=>"103.559998"}, "279"=>{"code"=>"906", "name"=>"Chranieng Khpos", "latitude"=>"11.1779", "longitude"=>"104.875"}, "280"=>{"code"=>"709", "name"=>"Chreav", "latitude"=>"13.3245", "longitude"=>"103.882004"}, "281"=>{"code"=>"879", "name"=>"Chres", "latitude"=>"10.9014", "longitude"=>"104.472"}, "282"=>{"code"=>"458", "name"=>"Chres Kaeut", "latitude"=>"11.6101", "longitude"=>"105.542999"}, "283"=>{"code"=>"462", "name"=>"Chrey", "latitude"=>"11.0613", "longitude"=>"105.595001"}, "284"=>{"code"=>"1301", "name"=>"Chrey Bak", "latitude"=>"12.1919", "longitude"=>"104.666"}, "285"=>{"code"=>"240", "name"=>"Chrey Cheung", "latitude"=>"12.7788", "longitude"=>"103.476997"}, "286"=>{"code"=>"717", "name"=>"Chrey Khang Cheung", "latitude"=>"13.2317", "longitude"=>"104.154999"}, "287"=>{"code"=>"869", "name"=>"Chrey Kouk Pou", "latitude"=>"10.8837", "longitude"=>"104.908997"}, "288"=>{"code"=>"1210", "name"=>"Chrey Loas", "latitude"=>"11.7169", "longitude"=>"104.788002"}, "289"=>{"code"=>"539", "name"=>"Chrey Phsar", "latitude"=>"11.5592", "longitude"=>"105.530998"}, "290"=>{"code"=>"1539", "name"=>"Chrey Pir", "latitude"=>"12.7776", "longitude"=>"103.476997"}, "291"=>{"code"=>"527", "name"=>"Chrey Thmei", "latitude"=>"10.9558", "longitude"=>"105.194"}, "292"=>{"code"=>"1763", "name"=>"Chrey Thum", "latitude"=>"11.0347", "longitude"=>"106.013"}, "293"=>{"code"=>"378", "name"=>"Chrey Yang", "latitude"=>"12.6638", "longitude"=>"107.237"}, "294"=>{"code"=>"1699", "name"=>"Chrouy Dang", "latitude"=>"11.4148", "longitude"=>"105.217003"}, "295"=>{"code"=>"90", "name"=>"Chrouy Krabau Ti Pir", "latitude"=>"11.8608", "longitude"=>"105.124001"}, "296"=>{"code"=>"1192", "name"=>"Chrouy Metrei Leu", "latitude"=>"11.778", "longitude"=>"105.014999"}, "297"=>{"code"=>"1444", "name"=>"Chrouy Neang Nguon", "latitude"=>"13.8293", "longitude"=>"103.517998"}, "298"=>{"code"=>"99", "name"=>"Chrouy Sdau", "latitude"=>"13.3298", "longitude"=>"103.059998"}, "299"=>{"code"=>"1255", "name"=>"Chrouy Svay Khang Kaeut", "latitude"=>"11.0285", "longitude"=>"103.677002"}, "300"=>{"code"=>"1357", "name"=>"Chrouy Thma", "latitude"=>"11.9952", "longitude"=>"105.471001"}, "301"=>{"code"=>"294", "name"=>"Chrouy Thma Kraom", "latitude"=>"12.2558", "longitude"=>"105.968002"}, "302"=>{"code"=>"1790", "name"=>"Chrouy Thma Leu", "latitude"=>"12.2511", "longitude"=>"105.976997"}, "303"=>{"code"=>"749", "name"=>"Chrung Sralau", "latitude"=>"10.6055", "longitude"=>"104.558998"}, "304"=>{"code"=>"1010", "name"=>"Chum Kriel", "latitude"=>"10.6063", "longitude"=>"104.209"}, "305"=>{"code"=>"1259", "name"=>"Chumnoab", "latitude"=>"11.6626", "longitude"=>"103.584"}, "306"=>{"code"=>"512", "name"=>"Chumpu Voan", "latitude"=>"11.741", "longitude"=>"105.533997"}, "307"=>{"code"=>"904", "name"=>"Chumrum", "latitude"=>"11.1402", "longitude"=>"104.873001"}, "308"=>{"code"=>"105", "name"=>"Chuor Kandal", "latitude"=>"12.1415", "longitude"=>"105.549004"}, "309"=>{"code"=>"968", "name"=>"Chuos", "latitude"=>"10.8092", "longitude"=>"104.808998"}, "310"=>{"code"=>"320", "name"=>"Chur Krouch", "latitude"=>"12.4277", "longitude"=>"106.151001"}, "311"=>{"code"=>"1033", "name"=>"Chvek", "latitude"=>"11.5786", "longitude"=>"104.598"}, "312"=>{"code"=>"959", "name"=>"Daeum Char", "latitude"=>"10.5511", "longitude"=>"104.445999"}, "313"=>{"code"=>"1270", "name"=>"Daeum Chreae", "latitude"=>"12.4139", "longitude"=>"104.473999"}, "314"=>{"code"=>"1622", "name"=>"Daeum Doung", "latitude"=>"10.7085", "longitude"=>"104.669998"}, "315"=>{"code"=>"1236", "name"=>"Daeum Kor", "latitude"=>"11.4862", "longitude"=>"104.945999"}, "316"=>{"code"=>"1109", "name"=>"Daeum Makkloea", "latitude"=>"11.5256", "longitude"=>"104.940002"}, "317"=>{"code"=>"1476", "name"=>"Daeum Mien", "latitude"=>"11.4828", "longitude"=>"104.950996"}, "318"=>{"code"=>"1480", "name"=>"Daeum Popel", "latitude"=>"11.9384", "longitude"=>"104.718002"}, "319"=>{"code"=>"102", "name"=>"Daeum Sdau", "latitude"=>"11.8841", "longitude"=>"105.438004"}, "320"=>{"code"=>"1110", "name"=>"Daeum Slaeng", "latitude"=>"11.5079", "longitude"=>"104.946999"}, "321"=>{"code"=>"381", "name"=>"Daeum Sral", "latitude"=>"12.4526", "longitude"=>"107.181999"}, "322"=>{"code"=>"1628", "name"=>"Dak Pou", "latitude"=>"13.358", "longitude"=>"103.876999"}, "323"=>{"code"=>"1631", "name"=>"Dam Daek Phsar", "latitude"=>"13.2429", "longitude"=>"104.125"}, "324"=>{"code"=>"143", "name"=>"Dam Spey", "latitude"=>"13.114", "longitude"=>"103.216003"}, "325"=>{"code"=>"1353", "name"=>"Dambae", "latitude"=>"12.0137", "longitude"=>"105.888"}, "326"=>{"code"=>"1365", "name"=>"Dambang Daek", "latitude"=>"11.9456", "longitude"=>"105.404999"}, "327"=>{"code"=>"1797", "name"=>"Damnak", "latitude"=>"13.8123", "longitude"=>"104.976997"}, "328"=>{"code"=>"601", "name"=>"Damnak Chambak", "latitude"=>"10.5557", "longitude"=>"104.285004"}, "329"=>{"code"=>"619", "name"=>"Damnak Chang'aeur", "latitude"=>"10.5417", "longitude"=>"104.310997"}, "330"=>{"code"=>"435", "name"=>"Damnak Chen", "latitude"=>"13.3774", "longitude"=>"105.124001"}, "331"=>{"code"=>"937", "name"=>"Damnak Kantuot", "latitude"=>"10.5741", "longitude"=>"104.463997"}, "332"=>{"code"=>"995", "name"=>"Damnak Kralanh Khang Kaeut", "latitude"=>"10.546", "longitude"=>"104.533997"}, "333"=>{"code"=>"1054", "name"=>"Damnak Luong", "latitude"=>"10.6949", "longitude"=>"104.267998"}, "334"=>{"code"=>"1280", "name"=>"Damnak Popul", "latitude"=>"12.241", "longitude"=>"104.675003"}, "335"=>{"code"=>"97", "name"=>"Damnak Pring Kaeut", "latitude"=>"11.841", "longitude"=>"105.426003"}, "336"=>{"code"=>"1679", "name"=>"Damnak Smach", "latitude"=>"11.7717", "longitude"=>"104.658997"}, "337"=>{"code"=>"1036", "name"=>"Damnak Trach", "latitude"=>"11.2922", "longitude"=>"104.321999"}, "338"=>{"code"=>"330", "name"=>"Damrae", "latitude"=>"12.8317", "longitude"=>"105.972"}, "339"=>{"code"=>"932", "name"=>"Damrei Leng", "latitude"=>"10.7132", "longitude"=>"104.504997"}, "340"=>{"code"=>"133", "name"=>"Damrel Ti Bei", "latitude"=>"11.8191", "longitude"=>"105.626999"}, "341"=>{"code"=>"564", "name"=>"Dang Rung", "latitude"=>"12.5635", "longitude"=>"103.892998"}, "342"=>{"code"=>"607", "name"=>"Dangkieb Kdam", "latitude"=>"12.2921", "longitude"=>"104.181999"}, "343"=>{"code"=>"382", "name"=>"Daoh Kramom", "latitude"=>"12.4623", "longitude"=>"107.182999"}, "344"=>{"code"=>"1283", "name"=>"Dar", "latitude"=>"12.3488", "longitude"=>"104.804001"}, "345"=>{"code"=>"116", "name"=>"Dar Kandal", "latitude"=>"11.7876", "longitude"=>"106.100998"}, "346"=>{"code"=>"1512", "name"=>"Dar Phsar", "latitude"=>"11.7845", "longitude"=>"106.088997"}, "347"=>{"code"=>"1136", "name"=>"Dei Edth Kaoh Phos", "latitude"=>"11.4959", "longitude"=>"105.084999"}, "348"=>{"code"=>"699", "name"=>"Dei Kraham", "latitude"=>"13.207", "longitude"=>"103.976997"}, "349"=>{"code"=>"1647", "name"=>"Dei Lou", "latitude"=>"13.4847", "longitude"=>"106.986"}, "350"=>{"code"=>"1032", "name"=>"Doek Peang", "latitude"=>"11.6447", "longitude"=>"104.667999"}, "351"=>{"code"=>"1688", "name"=>"Dom Khvet", "latitude"=>"11.7355", "longitude"=>"104.593002"}, "352"=>{"code"=>"555", "name"=>"Doun Ba", "latitude"=>"12.7614", "longitude"=>"103.247002"}, "353"=>{"code"=>"186", "name"=>"Doun Chhuk", "latitude"=>"12.9271", "longitude"=>"104.785004"}, "354"=>{"code"=>"1740", "name"=>"Doun Dom", "latitude"=>"12.0154", "longitude"=>"105.072998"}, "355"=>{"code"=>"452", "name"=>"Doun Koeng", "latitude"=>"11.5683", "longitude"=>"105.585999"}, "356"=>{"code"=>"9", "name"=>"Doun Loek", "latitude"=>"13.4488", "longitude"=>"103.228996"}, "357"=>{"code"=>"702", "name"=>"Doun Num", "latitude"=>"13.3091", "longitude"=>"104.000999"}, "358"=>{"code"=>"1737", "name"=>"Doun Paen", "latitude"=>"12.0832", "longitude"=>"104.977997"}, "359"=>{"code"=>"642", "name"=>"Doun Reach", "latitude"=>"13.1336", "longitude"=>"104.318001"}, "360"=>{"code"=>"822", "name"=>"Doun Sar", "latitude"=>"11.2221", "longitude"=>"105.728996"}, "361"=>{"code"=>"625", "name"=>"Doun Sva", "latitude"=>"13.6799", "longitude"=>"103.638"}, "362"=>{"code"=>"205", "name"=>"Doun Teav", "latitude"=>"13.1509", "longitude"=>"103.214996"}, "363"=>{"code"=>"1744", "name"=>"Doun Thi", "latitude"=>"12.123", "longitude"=>"105.342003"}, "364"=>{"code"=>"208", "name"=>"Doun Tor", "latitude"=>"12.2223", "longitude"=>"105.460999"}, "365"=>{"code"=>"199", "name"=>"Doung", "latitude"=>"13.2557", "longitude"=>"102.776001"}, "366"=>{"code"=>"73", "name"=>"Hai San", "latitude"=>"13.1078", "longitude"=>"103.141998"}, "367"=>{"code"=>"296", "name"=>"Hanchey Ti Bei", "latitude"=>"12.2542", "longitude"=>"105.944"}, "368"=>{"code"=>"801", "name"=>"Hang Khou Suon", "latitude"=>"13.5523", "longitude"=>"105.977997"}, "369"=>{"code"=>"943", "name"=>"Hat Pak", "latitude"=>"13.8445", "longitude"=>"106.697998"}, "370"=>{"code"=>"694", "name"=>"K'aek Tum", "latitude"=>"13.5377", "longitude"=>"103.742996"}, "371"=>{"code"=>"1171", "name"=>"K'am Samnar Kraom", "latitude"=>"10.9213", "longitude"=>"105.183998"}, "372"=>{"code"=>"396", "name"=>"Ka", "latitude"=>"13.9478", "longitude"=>"103.575996"}, "373"=>{"code"=>"1731", "name"=>"Ka At", "latitude"=>"11.9346", "longitude"=>"104.717003"}, "374"=>{"code"=>"944", "name"=>"Ka Choun Kraom", "latitude"=>"13.9621", "longitude"=>"106.889999"}, "375"=>{"code"=>"858", "name"=>"Ka Laeng", "latitude"=>"13.501", "longitude"=>"107.058998"}, "376"=>{"code"=>"845", "name"=>"Ka Nat", "latitude"=>"13.9273", "longitude"=>"107.254997"}, "377"=>{"code"=>"929", "name"=>"Ka Tang", "latitude"=>"13.7748", "longitude"=>"107.419998"}, "378"=>{"code"=>"460", "name"=>"Ka Thum", "latitude"=>"10.9949", "longitude"=>"105.558998"}, "379"=>{"code"=>"917", "name"=>"Ka Tieng", "latitude"=>"13.6361", "longitude"=>"106.957001"}, "380"=>{"code"=>"770", "name"=>"Kab Dai", "latitude"=>"13.8364", "longitude"=>"103.785004"}, "381"=>{"code"=>"1522", "name"=>"Kab Kou Thmei", "latitude"=>"13.1047", "longitude"=>"103.195"}, "382"=>{"code"=>"243", "name"=>"Kab Thlok", "latitude"=>"12.8972", "longitude"=>"104.721001"}, "383"=>{"code"=>"1040", "name"=>"Kab Tuk", "latitude"=>"11.3807", "longitude"=>"104.332001"}, "384"=>{"code"=>"1561", "name"=>"Kach Roteh", "latitude"=>"12.9496", "longitude"=>"103.348999"}, "385"=>{"code"=>"618", "name"=>"Kaeb", "latitude"=>"10.4905", "longitude"=>"104.325996"}, "386"=>{"code"=>"1380", "name"=>"Kaeb Thmei", "latitude"=>"10.5742", "longitude"=>"104.153"}, "387"=>{"code"=>"287", "name"=>"Kaeng Prasat", "latitude"=>"12.7648", "longitude"=>"105.973"}, "388"=>{"code"=>"1588", "name"=>"Kaev Sna", "latitude"=>"11.3515", "longitude"=>"105.499001"}, "389"=>{"code"=>"595", "name"=>"Kaev Sovann Leu", "latitude"=>"12.5464", "longitude"=>"103.929001"}, "390"=>{"code"=>"848", "name"=>"Kak", "latitude"=>"13.7042", "longitude"=>"107.238998"}, "391"=>{"code"=>"272", "name"=>"Kakaoh", "latitude"=>"12.8436", "longitude"=>"103.400002"}, "392"=>{"code"=>"70", "name"=>"Kaksekam", "latitude"=>"13.2623", "longitude"=>"103.093002"}, "393"=>{"code"=>"923", "name"=>"Kalai Pir", "latitude"=>"13.8351", "longitude"=>"106.955002"}, "394"=>{"code"=>"856", "name"=>"Kam Bak", "latitude"=>"13.6774", "longitude"=>"106.848999"}, "395"=>{"code"=>"305", "name"=>"Kambaor", "latitude"=>"12.5377", "longitude"=>"106.067001"}, "396"=>{"code"=>"453", "name"=>"Kamchay Mear Cheung", "latitude"=>"11.6147", "longitude"=>"105.691002"}, "397"=>{"code"=>"1407", "name"=>"Kammeak Neath", "latitude"=>"12.5607", "longitude"=>"105.052002"}, "398"=>{"code"=>"881", "name"=>"Kamnab", "latitude"=>"11.0339", "longitude"=>"104.472"}, "399"=>{"code"=>"1330", "name"=>"Kampal", "latitude"=>"12.1196", "longitude"=>"104.975998"}, "400"=>{"code"=>"621", "name"=>"Kampeaeng", "latitude"=>"12.402", "longitude"=>"103.814003"}, "401"=>{"code"=>"775", "name"=>"Kamphun", "latitude"=>"13.5508", "longitude"=>"106.095001"}, "402"=>{"code"=>"117", "name"=>"Kampoan", "latitude"=>"11.9229", "longitude"=>"106.099998"}, "403"=>{"code"=>"1454", "name"=>"Kampong", "latitude"=>"10.6469", "longitude"=>"104.875"}, "404"=>{"code"=>"1466", "name"=>"Kampong Bay Khang Cheung", "latitude"=>"10.6116", "longitude"=>"104.181999"}, "405"=>{"code"=>"1071", "name"=>"Kampong Bay Khang Tboung", "latitude"=>"10.613", "longitude"=>"104.185997"}, "406"=>{"code"=>"1284", "name"=>"Kampong Boeng", "latitude"=>"12.2712", "longitude"=>"104.730003"}, "407"=>{"code"=>"979", "name"=>"Kampong Cham", "latitude"=>"13.9451", "longitude"=>"106.760002"}, "408"=>{"code"=>"98", "name"=>"Kampong Chamlang", "latitude"=>"11.924", "longitude"=>"105.322998"}, "409"=>{"code"=>"1369", "name"=>"Kampong Chanloh Lech", "latitude"=>"12.0937", "longitude"=>"105.552002"}, "410"=>{"code"=>"1547", "name"=>"Kampong Chheu Teal", "latitude"=>"12.8688", "longitude"=>"105.071999"}, "411"=>{"code"=>"1058", "name"=>"Kampong Kaes", "latitude"=>"10.5937", "longitude"=>"104.246002"}, "412"=>{"code"=>"1542", "name"=>"Kampong Kdei", "latitude"=>"12.9388", "longitude"=>"104.574997"}, "413"=>{"code"=>"640", "name"=>"Kampong Kdei Pir", "latitude"=>"13.1212", "longitude"=>"104.343002"}, "414"=>{"code"=>"1702", "name"=>"Kampong Kong", "latitude"=>"11.1392", "longitude"=>"105.080002"}, "415"=>{"code"=>"325", "name"=>"Kampong Kor", "latitude"=>"12.272", "longitude"=>"105.966003"}, "416"=>{"code"=>"244", "name"=>"Kampong Kou Leu", "latitude"=>"12.7089", "longitude"=>"104.794998"}, "417"=>{"code"=>"195", "name"=>"Kampong Krabei", "latitude"=>"13.0959", "longitude"=>"103.202003"}, "418"=>{"code"=>"1011", "name"=>"Kampong Kraeng", "latitude"=>"10.6368", "longitude"=>"104.178001"}, "419"=>{"code"=>"899", "name"=>"Kampong Leav", "latitude"=>"11.1587", "longitude"=>"105.023003"}, "420"=>{"code"=>"1446", "name"=>"Kampong Luong", "latitude"=>"10.9912", "longitude"=>"104.981003"}, "421"=>{"code"=>"483", "name"=>"Kampong Popil", "latitude"=>"11.6532", "longitude"=>"105.141998"}, "422"=>{"code"=>"759", "name"=>"Kampong Pou", "latitude"=>"10.9889", "longitude"=>"104.982002"}, "423"=>{"code"=>"374", "name"=>"Kampong Preah", "latitude"=>"13.0255", "longitude"=>"103.306"}, "424"=>{"code"=>"1384", "name"=>"Kampong Preah Ent", "latitude"=>"13.9747", "longitude"=>"105.848999"}, "425"=>{"code"=>"1228", "name"=>"Kampong Pring", "latitude"=>"11.4285", "longitude"=>"105.049004"}, "426"=>{"code"=>"419", "name"=>"Kampong Putrea", "latitude"=>"13.5136", "longitude"=>"105.195"}, "427"=>{"code"=>"94", "name"=>"Kampong Reab Kraom", "latitude"=>"11.9129", "longitude"=>"105.373001"}, "428"=>{"code"=>"596", "name"=>"Kampong Roka", "latitude"=>"12.6025", "longitude"=>"103.949997"}, "429"=>{"code"=>"202", "name"=>"Kampong Sambuor", "latitude"=>"13.1343", "longitude"=>"103.223999"}, "430"=>{"code"=>"1238", "name"=>"Kampong Samnanh", "latitude"=>"11.4671", "longitude"=>"104.948997"}, "431"=>{"code"=>"1521", "name"=>"Kampong Seima", "latitude"=>"13.0537", "longitude"=>"103.198997"}, "432"=>{"code"=>"450", "name"=>"Kampong Snae", "latitude"=>"11.3744", "longitude"=>"105.398003"}, "433"=>{"code"=>"1383", "name"=>"Kampong Sralau", "latitude"=>"14.0807", "longitude"=>"105.787003"}, "434"=>{"code"=>"a1", "name"=>"Kampong Leav1", "latitude"=>"11.1587", "longitude"=>"105.023003"}, "435"=>{"code"=>"a2", "name"=>"Kampong Luong2", "latitude"=>"10.9912", "longitude"=>"104.981003"}, "436"=>{"code"=>"a3", "name"=>"Kampong Popil3", "latitude"=>"11.6532", "longitude"=>"105.141998"}, "437"=>{"code"=>"a4", "name"=>"Kampong Pou4", "latitude"=>"10.9889", "longitude"=>"104.982002"}, "438"=>{"code"=>"a5", "name"=>"Kampong Preah5", "latitude"=>"13.0255", "longitude"=>"103.306"}}
      field_location = {"name"=>"location", "code"=>"location", "kind"=>"location", "ord"=>"1", "layer_id"=>"56", "is_enable_field_logic"=>"false", "config"=>{locations: config_locations}}
      layer = {"name"=>"layer1", "ord"=>"1", "fields_attributes"=>{"0"=>field_location}}

      post :create, {layer: layer, collection_id: collection.id}

      response.should be_success
      json = JSON.parse response.body
      json["name"].should eq("layer1")
      json["fields"][0]["name"].should eq("location")
      json["fields"][0]["code"].should eq("location")
      json["fields"][0]["kind"].should eq("location")
      json["fields"][0]["config"]["locations"].size.should eq(439)
    end
  end

end
